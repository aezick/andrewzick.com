<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Days since...</title>

		<meta http-equiv="x-ua-compatible" content="ie=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<meta name="description" content="a bunch of counters that interact with each other">
		<meta name="author" content="Andrew Zick">

		<!-- Bootstrap -->
		<link rel="stylesheet" href="static/css/bootstrap.min.css" >
		<!-- Normalize -->
		<link rel="stylesheet" href="static/css/normalize.css">
		<!-- main.css -->
		<link rel="stylesheet" href="static/css/main.css">
		<!-- blog.css -->
		<link rel="stylesheet" href="static/css/days-since.css">
		<!-- Font -->
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu+Condensed">
	</head>

	<body>
		<div class="container">
			<header class="header">
				<nav class="navbar navbar-default navbar-static-top">
					<div class="container-fluid">
						<div class="navbar-header">
							<a class="navbar-brand" href="/">tick tock<span class="sr-only">(current)</span></a>
						</div>
						<ul class="nav navbar-nav navbar-right">
							<li><a href="mailto:andrewzick@gmail.com" target="_blank">
								Suggest a new counter?
							</a></li>
						</ul>
					</div><!-- /.container-fluid -->
				</nav>
			</header><!-- /header -->
			<hr>
			<div class="row">
				<div class="col-lg-3 left-side">
					<img id="futurama-days-since" src="/static/img/futurama_days_since.gif">
				</div>
				<div class="col-lg-7 col-main blog-title">
					<script type="text/javascript">
						// from here https://stackoverflow.com/a/11252167
						function treatAsUTC(date) {
							var result = new Date(date);
							result.setMinutes(result.getMinutes() - result.getTimezoneOffset());
							return result;
						}

						function daysBetween(startDate, endDate) {
							var millisecondsPerDay = 24 * 60 * 60 * 1000;
							return Math.floor((treatAsUTC(endDate) - treatAsUTC(startDate)) / millisecondsPerDay);
						}
					</script>
					<h1>Days since...</h1>
					<hr>

					<!-- the original counter -->
					<h4 class="counter-text">this page was created</h4>
					<h4 id="counterDateCreated" class="counter-num"></h4>
					<script type="text/javascript">
						dateCreated = new Date(2019, 5, 2);	// June 2nd, 2019
						document.getElementById("counterDateCreated").innerHTML = daysBetween(dateCreated, new Date());
					</script>
					<hr>

					<!-- new counter counter -->
					<h4 class="counter-text">a new counter was added to this page</h4>
					<h4 id="counterNewCounterAdded" class="counter-num"></h4>
					<script type="text/javascript">
						dateCreated = new Date(2019, 5, 2);	// June 2nd, 2019
						document.getElementById("counterNewCounterAdded").innerHTML = daysBetween(dateCreated, new Date());
					</script>
					<hr>

					<!-- first visit counter -->
					<h4 class="counter-text">you first visited this page</h4>
					<h4 id="counterLastVisited" class="counter-num"></h4>
					<script type="text/javascript">
						if (localStorage.firstVisited) {
							firstVisited = localStorage.firstVisited;
						} else {
							localStorage.firstVisited = new Date().toString();
							firstVisited = localStorage.firstVisited;
						}
						document.getElementById("counterLastVisited").innerHTML = daysBetween(firstVisited, new Date());
					</script>
					<hr>

					<!-- prime sum counter -->
					<h4 class="counter-text">the sum of the above counters was prime (when you visited)</h4>
					<h4 id="counterPrimeSum" class="counter-num"></h4>
					<script type="text/javascript">
						// from here https://stackoverflow.com/a/40200710/2521402
						const isPrime = num => {
							for(let i = 2, s = Math.sqrt(num); i <= s; i++)
								if(num % i === 0) return false; 
							return num > 1;
						}

						isPrimeSum = isPrime(
							parseInt(document.getElementById("counterDateCreated").innerHTML) +
							parseInt(document.getElementById("counterNewCounterAdded").innerHTML) +
							parseInt(document.getElementById("counterLastVisited").innerHTML)
						);

						// if the sum of the counters is prime, reset this counter
						if (localStorage.lastPrimeSum) {
							if (isPrimeSum) {
								localStorage.lastPrimeSum = new Date().toString();
							}
							lastPrimeSum = localStorage.lastPrimeSum;
						} else {
							localStorage.lastPrimeSum = "n/a";
							lastPrimeSum = localStorage.lastPrimeSum;
						}

						document.getElementById("counterPrimeSum").innerHTML = daysBetween(lastPrimeSum, new Date());
					</script>

				</div>
				<div class="col-lg-2"></div>
			</div>
			<hr>
		</div>
	</body>
</html>